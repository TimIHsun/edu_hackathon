---
title: "activities clawer"
output: html_document
---

```{r}
library(rvest);library(magrittr);library(stringr);library(dplyr);library(xlsx);library(xml2);library(stringr)
```

# å°å¤§æ¼”è¬›ç¶² https://speech.ntu.edu.tw/ntuspeech/Topic/ (æ’é™¤)
``{r}
ntu.speech.url <- paste0("https://speech.ntu.edu.tw/ntuspeech/Topic/detail/id-",c(5,7,25,17,15,8,26,16,23,19,22,21,10))

speech <- data.frame("source" = "ntu.speech",
                         "url" = ntu.speech.url)
``

* find speech title, video url, img
``{r}
activities <- data.frame()
for (i in speech$url) {
  path = "/html/body/div/div/div/div/div[1]/div"
  htmlconten <- read_html(i) 
  
  title <- htmlconten %>% html_nodes(xpath = path) %>%
    html_nodes("h4") %>% html_text() %>%
    str_remove_all(.,"[\r\n]+(?<=\r\n)[:blank:]+")
  
  date <- htmlconten %>% 
    html_nodes(xpath = path) %>% 
    html_nodes("div.col-sm-7.col-xs-6 div.videolist-date") %>%
    html_text() %>%
    str_remove_all(.,"[\r\n]+(?<=\r\n)[:blank:]+")
  
  url <- htmlconten %>% html_nodes(xpath = path) %>%
    html_nodes("div a") %>% html_attr(., "href") %>%
    unique()
  
  img <- htmlconten %>% html_nodes(xpath = path) %>%
    html_nodes("div img") %>% html_attr(.,"src")
  
  activities <- data.frame("from" = "ntu speech",
             "title" = title,
             "organizer" = "å°å¤§æ¼”è¬›ç¶²",
             "date" = date,
             "age_limit" = NA,
             "sub_type" = NA,
            "img_url" = img,
            "url" = url,
            "description" = title) %>%
    rbind(activities,.)
}
``


# é’å¹´ç½²æ´»å‹•
```{r}
yda.to_df <- function(url, type){
  path = "/html/body/form/section[2]/div[2]/div[2]"
  read_html(url) %>%
  html_nodes(xpath = path) -> html.need
  
  html.need %>%
    html_nodes("div div.project div.info") %>%
    html_text() %>%
    str_remove(., "^[:blank:]+") %>%
    str_remove(., "[:blank:]+more[:blank:]+") %>%
    str_split(., "      ") -> info
  
  html.need %>%
    html_nodes("div div.project div.info a") %>%
    html_attr(.,"href") %>%
    paste0("https://youth-resources.yda.gov.tw/",.) -> act.url
  
  html.need %>%
    html_nodes("div div.project div.info div.picture img") %>%
    html_attr(., "src") %>%
    paste0("https://youth-resources.yda.gov.tw/",.) -> img.url
  
  # æ•´ç†æˆdata frame
  data.frame("from" = "yda",
             "type_1" = NA,
             "type_2" = rep(type, length(info)),
             "type_3" = NA,
             "title" = NA,  # info.title
             "organizer" = NA,  # info.organizer
             "date" = NA,  # info.date
             "age_limit" = NA,  # info.limit
             "sub_type" = NA,
             "url" = NA,
             "img_url" = NA,
             "description" = NA) -> yda  # info.sub

  for (i in seq(info)) {
    yda$title[i] <- info[[i]][1]
    yda$organizer[i] <- info[[i]][2]
    yda$date[i] <- info[[i]][3] %>% 
      str_remove(., "ç”³è«‹æœŸé™ï¼š")
    yda$age_limit[i] <- info[[i]][5] %>%
      str_remove(.,"ç”³è«‹å°è±¡ï¼š")
    yda$sub_type[i] <- info[[i]][4] %>%
      str_remove(.,"ç”³è«‹é¡å‹ï¼š")
    yda$img_url[i] <- img.url[i]
    yda$url[i] <- act.url[i]
  }
  as.character(yda$type_2) -> yda$type_2
  return(yda)
}

get_descrip <- function(url){  # yda$url[i]
  url %>% read_html(.) %>%
    html_nodes("div.desc p") %>%
    html_text()
}
```


## å…¬å…±åƒèˆ‡
```{r}
yda.to_df("https://youth-resources.yda.gov.tw/subject/index/rUDNGGp_8qknup-tq6WaPQ/VdG5dsG8L3SHsMOYgWI_Yw", "ç¤¾æœƒåƒèˆ‡") -> yda
```

### type_1 å’Œ type_2, type_3 ä¿®æ”¹
``{r}
yda$type_1[c(1:4,6:10)] <- "è·æ¶¯é¸æ“‡"
yda$type_1[5] <- "ç²¾ç¥æˆé•·"
yda$type_1[9] <- "ç²¾ç¥æˆé•·"

yda$type_3[c(2:3,7)] <- "å‰µæ–°å‰µæ„"
yda$type_3[c(5,8)] <- "è—è¡“æ–‡åŒ–"
yda$type_3[c(6)] <- "è¾²æ¥­"

yda$type_2[c(6)] <- "å‰µæ–°å‰µæ„"
yda$type_2[4] <- NA
``

### çˆ¬æ¯å€‹æ´»å‹•çš„èªªæ˜
```{r}
for (i in c(1:3)) {
  yda$url[i] %>% read_html(.) %>%
    html_nodes("div.desc p") %>%
    html_text() %>%
    .[1] -> yda$description[i]
}

for (i in c(4:6)) {
  yda$url[i] %>% read_html(.) %>%
    html_nodes("div.desc p") %>%
    html_text() %>%
    .[1:4] %>%
    paste(., collapse = ";") -> yda$description[i]
}

for (i in c(7:10)) {
  yda$url[i] %>% read_html(.) %>%
    html_nodes("div.desc p") %>%
    html_text() %>%
    .[2] %>%
    paste(., collapse = ";") -> yda$description[i]
}
# å°‡æ´»å‹•ä½µå…¥é’å¹´ç½²æ´»å‹•çš„ç¸½è¡¨
activities.yda <- data.frame()
rbind(activities.yda, yda) -> activities.yda
activities.yda
```

## å‰µæ–°å­¸ç¿’-type need change
```{r}
yda.to_df("https://youth-resources.yda.gov.tw/subject/index/3NSVufX3zV_NfqYtUIupkg/VdG5dsG8L3SHsMOYgWI_Yw", "å‰µæ–°å‰µæ„") -> yda
```

### ä¿®æ”¹type
``{r}
yda$type_1[c(1,4,5,7,8)] <- "æŠ€è¡“æå‡"
yda$type_1[c(2,6,10)] <- "è·æ¶¯é¸æ“‡"
yda$type_1[c(3,9)] <- "ç²¾ç¥æˆé•·"

yda$type_3[c(2,4)] <- "ç¤¾æœƒåƒèˆ‡"
yda$type_3[c(1,10)] <- "è³‡è¨Š"
yda$type_3[c(3:5,7)] <- "è—è¡“æ–‡åŒ–"
yda$type_3[c(8)] <- "è¾²æ¥­"
yda$type_3[9] <- "è‡ªç„¶ç§‘å­¸"
yda$type_2[6] <- NA
``

### åŠ description
```{r}
for (i in c(1:2)) {
  yda$url[i] %>%
    read_html() %>%
    html_nodes("div.desc p") %>%
    html_text() %>% .[2] -> yda$description[i]
}

for (i in c(3,5)) {
  yda$url[i] %>%
    read_html() %>%
    html_nodes("div.desc p") %>%
    html_text() %>% 
    {paste(.[c(1:2)],collapse = "")} -> yda$description[i]
}

for (i in c(4, 6:10)) {
  yda$url[i] %>%
    read_html() %>%
    html_nodes("div.desc p") %>%
    html_text() %>% 
    .[1] -> yda$description[i]
}

# å°‡æ´»å‹•ä½µå…¥é’å¹´ç½²æ´»å‹•çš„ç¸½è¡¨
rbind(activities.yda, yda) -> activities.yda
```

## å°±æ¥­å‰µæ¥­
```{r}
yda.to_df("https://youth-resources.yda.gov.tw/subject/index/NXWB0vXeK9r7IQwKq3GEjw/VdG5dsG8L3SHsMOYgWI_Yw", "å°±æ¥­å‰µæ¥­") -> yda
```

``{r}
yda$type_1 <- "è·æ¶¯é¸æ“‡"
yda$type_1[10] <- "æŠ€è¡“æå‡"

yda$type_2[c(1:5,7)] <- "å‰µæ–°å‰µæ„"
yda$type_2[c(6)] <- "å•†ç®¡"
yda$type_2[c(8)] <- "ç¤¾æœƒåƒèˆ‡"
yda$type_2[9] <- NA

yda$type_3[c(1,3)] <- "è—è¡“æ–‡åŒ–"
yda$type_3[c(2,4,7)] <- "å•†ç®¡"
yda$type_3[c(5)] <- "è¾²æ¥­"
``

```{r}
for (i in c(1,6:10)) {
  yda$url[i] %>%
    read_html() %>%
    html_nodes("div.desc p") %>%
    html_text() %>% .[1] -> yda$description[i]
}

for (i in c(2,3)) {
  yda$url[i] %>%
    read_html() %>%
    html_nodes("div.desc p") %>%
    html_text() %>% .[2] -> yda$description[i]
}

yda$url[4] %>%
    read_html() %>%
    html_nodes("div.desc p") %>%
    html_text() %>% .[c(2:3)] %>% 
    {paste(.[c(1:2)],collapse = "")} -> yda$description[4]

yda$url[5] %>%
    read_html() %>%
    html_nodes("div.desc p") %>%
    html_text() %>% .[c(1:4)] %>% 
    {paste(.[c(1:4)],collapse = "ã€‚")} -> yda$description[5]

# å°‡æ´»å‹•ä½µå…¥é’å¹´ç½²æ´»å‹•çš„ç¸½è¡¨
rbind(activities.yda, yda) -> activities.yda
```

## åœ‹éš›åƒèˆ‡

```{r}
yda.to_df("https://youth-resources.yda.gov.tw/subject/index/eJ1WgKmY6TZd6ZZ7YFbcmQ/VdG5dsG8L3SHsMOYgWI_Yw", "ç¤¾æœƒåƒèˆ‡") -> yda
```

### ä¿®æ”¹ type
``{r}
yda$type_1[c(1:2,4)] <- "è·æ¶¯é¸æ“‡"
yda$type_1[c(3,5,9)] <- "ç²¾ç¥æˆé•·"
yda$type_1[c(6:8,10)] <- "æŠ€è¡“æå‡"

yda$type_2[c(2,6:8)] <- "å‰µæ–°å‰µæ„"
yda$type_2[c(4)] <- "å•†ç®¡"

yda$type_3[c(2)] <- "å•†ç®¡"
yda$type_3[c(8)] <- "è—è¡“æ–‡åŒ–"
yda$type_3[c(10)] <- "è¾²æ¥­"
``

### description
```{r}
for (i in c(1,4,6,7,9,10)) {
  get_descrip(yda$url[i])[1] -> yda$description[i]
}

for (i in c(2,3,8)) {
  get_descrip(yda$url[i])[2] -> yda$description[i]
}

get_descrip(yda$url[5])[5:7] %>%
  paste(.,collapse = "") -> yda$description[5]

# å°‡æ´»å‹•ä½µå…¥é’å¹´ç½²æ´»å‹•çš„ç¸½è¡¨
rbind(activities.yda, yda) -> activities.yda
```


## activities.yda to activites
```{r}
activities.yda %>% select(., -type_1, -type_2, -type_3, -sub_type, act_date = date) %>%
  mutate(reg_date = NA) -> activities

activities
```


# å¤§å­¸ç‡ŸéšŠ
* é«˜å¸«é™„ä¸­ http://sites.tea.nknush.kh.edu.tw/fu-dao-zhong-xin/da-xue-ying-dui-tuan-dui
```{r}
university.url = "http://sites.tea.nknush.kh.edu.tw/fu-dao-zhong-xin/da-xue-ying-dui-tuan-dui"

# get titles
camp.title <- read_html(university.url) %>%
  html_nodes(xpath = "/html/body/div[2]/div/div[1]/div/div[2]/div/table") %>%
  html_nodes("tbody td.goog-ws-list-url") %>%
  html_text()

# get link of camp
camp.url <- read_html(university.url) %>%
  html_nodes(xpath = "/html/body/div[2]/div/div[1]/div/div[2]/div/table") %>%
  html_nodes("tbody td.goog-ws-list-url a") %>%
  html_attr(., "href")

# arrange to a data frame
camp <- data.frame("from" = NA,
                   "title" = camp.title,
                   "url" = camp.url)
camp$url <- camp$url %>% str_remove(., "%20(?=/)")  # modify the link

# get camps with useful link
camp <- camp[str_which(camp$url, "^https"),]
camp <- camp[c(1:3,7:15),]
```

```{r}
# modify detail information function
modify_info <- function(i, fr, organ, reg_d, act_d, age, img, descripe){
  camp$from[i] <- fr
  camp$organizer[i] <- organ
  camp$reg_date[i] <- reg_d
  camp$act_date[i] <- act_d
  camp$age_limit[i] <- age
  camp$img_url[i] <- img
  camp$description[i] <- descripe
  return(camp)
}
```

```{r}
# get detail information
# åŒ—å¤§é‡‘èç‡Ÿ
camp <- modify_info(1, "åœ‹ç«‹å°åŒ—å¤§å­¸", "åœ‹ç«‹å°åŒ—å¤§å­¸", "2020/10/1-10/31","2021/2/1-2/4","15æ­²~18æ­²",
            "https://scontent.ftpe8-2.fna.fbcdn.net/v/t1.0-0/p180x540/118695561_3413912401999814_953501754491201642_o.jpg?_nc_cat=103&_nc_sid=e3f864&_nc_ohc=IE5V3eB9KL0AX_xTGzP&_nc_ht=scontent.ftpe8-2.fna&tp=6&oh=ac5ff749dc07fd748dcb5695573f8a6b&oe=5FA51667", "åœ‹ç«‹è‡ºåŒ—å¤§å­¸ç¬¬åäºŒå±†é‡‘èç ”ç¿’ç‡Ÿ")
```

```{r}
# äº¤å¤§å¥ˆç±³ç‡Ÿ
camp <- modify_info(2, "åœ‹ç«‹äº¤é€šå¤§å­¸", "åœ‹ç«‹äº¤é€šå¤§å­¸", "2020/10/4 - 12/31","2021/2/5-2/9","15æ­²~18æ­²",
            "https://scontent.ftpe8-3.fna.fbcdn.net/v/t1.0-9/s960x960/120260955_3441678105890548_3420861663583180682_o.jpg?_nc_cat=106&_nc_sid=e3f864&_nc_ohc=tNOUVmQAWvEAX9u2gzI&_nc_ht=scontent.ftpe8-3.fna&tp=7&oh=54e9b98b679d19180be250c96f67e416&oe=5FA744FE", 
            "2021åœ‹ç«‹äº¤é€šå¤§å­¸å¥ˆç±³ç‡Ÿå ±åè¡¨å–®æ­£å¼é–‹è·‘å•¦ï¼ç›¸ä¿¡èº«ç‚ºé«˜ä¸­ç”Ÿçš„ä½ ä½ ä½ ä½ ä½ é‚„æœ‰ä½ ï¼Œçµ•å°ä¸æœƒçŸ¥é“è‡ªå·±çœŸæ­£å–œæ­¡ä»€éº¼æ“…é•·ä»€éº¼ï¼Œä¹Ÿä¸çŸ¥é“è‡ªå·±å°‡ä¾†è¦å¿µä»€éº¼ç§‘ç³»ï¼Œé€™æ™‚å€™ä¾†å¥ˆç±³ç§‘å­¸ç‡Ÿå°‡æ˜¯ä½ æœ€å¥½çš„é¸æ“‡ï¼å¥ˆç±³å­¸å£«ç­æ˜¯å…¨å°å”¯ä¸€æ©«è·¨é›»å­/ææ–™/ç”Ÿç§‘/å…‰é›» å››å€‹é ˜åŸŸçš„å­¸ç³»ã€‚å¯ä»¥è®“ä½ å……åˆ†é«”é©—å››å¤§é ˜åŸŸçš„èª²ç¨‹èˆ‡ç²¾é«“ï¼Œè®“è‡ªå·±ä¸å†è¿·æƒ˜ï¼Œå°æœªä¾†è¦åŠƒçµ•å°å¹«åŠ©ç”šå¤§ï¼ä¸è«–ä½ æƒ³æ¢ç´¢è‡ªå·±å–œæ­¡çš„é ˜åŸŸï¼ŒæŠ‘æˆ–æ˜¯æƒ³èªè­˜å¥ˆç±³å­¸å£«ç­ï¼Œç”šè‡³åªæ˜¯å¯’å‡é–’é–’æ²’äº‹å¹¹ï¼Œé€™æ™‚å€™å°±ä¾†äº¤é€šå¤§å­¸å¥ˆç±³ç§‘å­¸ç‡Ÿï¼Œé«”é©—å››å¤§é ˜åŸŸå°ˆå±¬èª²ç¨‹ï¼Œæ›´æœ‰å¯“æ•™æ–¼æ¨‚çš„å„ç¨®éŠæˆ²æŒ‘æˆ°ï¼Œé‚„èƒ½çµè­˜ä¾†è‡ªå…¨å°å„è·¯çš„å¤¥ä¼´ï¼Œè®“ä½ çš„å¯’å‡ä¸å†ç©ºç™½ï¼Œåœ¨å¥ˆç±³ç§‘å­¸ç‡Ÿç™¼ç¾ä½ è‡ªå·±ï¼åœ¨2021å¯’å‡ï¼Œçµ¦è‡ªå·±ä¸€å€‹ä¸ä¸€æ¨£çš„é¸æ“‡ï¼Œèªè­˜å…¨æ–°çš„ä½ è‡ªå·±ã€‚")
```

```{r}
# å˜‰å¤§å»£å‘Šç‡Ÿ
camp <- modify_info(3, "åœ‹ç«‹å˜‰ç¾©å¤§å­¸", "åœ‹ç«‹å˜‰ç¾©å¤§å­¸", "2020/10/2 - 12/01","2021/01/26-01/29", "15æ­²~18æ­²",
            "https://scontent.ftpe8-2.fna.fbcdn.net/v/t1.0-9/s960x960/118943086_831628697576234_1507107965555619985_o.jpg?_nc_cat=100&_nc_sid=e3f864&_nc_ohc=3fBvcJDLcOUAX_3dLCA&_nc_ht=scontent.ftpe8-2.fna&tp=7&oh=87eb5c96ebb3f7722ad1679d7a2a6760&oe=5FA78D82",
            "é™¤äº†ç©ºæ‹æ©Ÿã€æ–‡æ¡ˆç°¡å ±è¨­è¨ˆã€é¡é ­èªè¨€ã€Prå‰ªè¼¯ä¹‹å¤–ï¼Œé‚„æœ‰å¾ˆå¤šç²¾å½©çš„æˆ¶å¤–æ´»å‹•ï¼Œå¿ƒå‹•ä¸å¦‚é¦¬ä¸Šè¡Œå‹•è¶•ç·Šçš„å ±åèºèµ·ä¾†:ç©ºæ‹æ©Ÿ | ç©¿æ¢­æ–¼è—å¤©çš„æ„Ÿå‹•ï¼ŒAdobe Illustrator CC | åŸºç¤å·¥å…·ç¹ªåœ–æŠ€å·§ï¼Œå»£å‘Šæ–‡æ¡ˆ/ç°¡å ±è¨­è¨ˆ/é¡é ­èªè¨€/å½±åƒæ§‹åœ– | æ–‡æ¡ˆè£½ä½œæ‹æ”æŠ€å·§(ç°¡å ±è¨­è¨ˆæ˜¯æ–°å¢åŠ çš„èª²ç¨‹å“¦ï¼Œä¸€å€‹æ–‡æ¡ˆå‘ˆç¾æ™‚å¦‚ä½•æ›´æŠ“ä½åˆ¥äººçš„ç›®å…‰ï¼Œçµ•å°ä¸è¦éŒ¯éğŸ˜†)ï¼ŒAdobe Premiere Pro | å¾ŒæœŸå¾Œè£½å‰ªè¼¯èª¿è‰²")
```

```{r}
# ä¸­åœ‹æ–‡åŒ–å¤§å­¸ ã€Œ å¤§å­¸ç”Ÿæ´»é«”é©—ç‡Ÿ é£›èºä¿„ç¾…æ–¯ ã€ 
camp <- modify_info(4, "ä¸­åœ‹æ–‡åŒ–å¤§å­¸", "ä¸­åœ‹æ–‡åŒ–å¤§å­¸", "2020/09/28-10/18","2020/10/31", "15æ­²~18æ­²","https://crgarl.pccu.edu.tw/ezfiles/80/1080/img/2092/446509105.jpg", "æ´»å‹•å…§å®¹ä»¥ã€Œä¿„ç¾…æ–¯æ¢ç´¢èª²ç¨‹ã€ç‚ºä¸»è»¸ï¼ŒåŒæ™‚å®‰æ’æœ‰ã€Œæ ¡åœ’å°è¦½ã€ã€‚ã€Œä¿„ç¾…æ–¯æ¢ç´¢èª²ç¨‹ã€åŒ…æ‹¬ä¿„ç¾…æ–¯æ–‡åŒ–ä»‹ç´¹ã€ç¾é£ŸåŠå‚³çµ±æ‰‹å·¥è—å“å¯¦ä½œã€å­¸ç”ŸéŠå­¸è¦‹èåˆ†äº«ç­‰å±•ç¾æœ¬ç³»ç‰¹è‰²ã€‚ã€Œæ ¡åœ’å°è¦½ã€å‰‡è¦åŠƒå¸¶é ˜å­¸ç”Ÿèªè­˜æœ¬æ ¡åœ–æ›¸é¤¨ä¹‹ä¿„æ–‡è—æ›¸ã€é«”è‚²é¤¨ç­‰ä¹‹å­¸ç¿’ç’°å¢ƒã€‚")
```

```{r}
# ç¬¬åå±†å˜‰ç¾©å¤§å­¸ç”ŸåŒ–ç‡Ÿ 
camp <- modify_info(5, "åœ‹ç«‹å˜‰ç¾©å¤§å­¸", "åœ‹ç«‹å˜‰ç¾©å¤§å­¸", "2020/09/28-11/30","2021/02/01-02/04","15æ­²~18æ­²",
                    "https://static.wixstatic.com/media/af31fb_c4614b2ae1234b3bb52ac9a3daca0bab~mv2.png/v1/fill/w_469,h_645,al_c,q_85/%E7%94%9F%E5%8C%96%E7%87%9F%E6%B5%B7%E5%A0%B1%20%E5%AE%9A.webp",
                    "èª²ç¨‹ä¸€ï¼šå¾®ç”Ÿç‰©æ‡‰ç”¨ï¼Œå¾®ç”Ÿç‰©åœ¨æˆ‘å€‘ç”Ÿæ´»ä¸­ç„¡æ‰€ä¸åœ¨ï¼Œæœ‰å¾ˆå¤šæ‡‰ç”¨ï¼Œåƒæ˜¯è¾²æ¥­çš„å¾®ç”Ÿç‰©è‚¥æ–™ã€é†«ç™‚ç”¨æŠ—ç”Ÿç´ ã€å•¤é…’ã€é†¬æ²¹â€¦â€¦ç­‰ã€‚èª²ç¨‹äºŒï¼šç²—DNAèƒå–ï¼ŒDNAæ˜¯ç”±äº”ç¢³ç³–ã€å«æ°®é¹¼åŸºã€ç£·é…¸ç­‰ç‰©è³ªæ‰€çµ„æˆï¼ŒDNAé€™åè©æˆ‘å€‘ä¸¦ä¸é™Œç”Ÿï¼Œæƒ³å°å®ƒæœ‰æ›´å¤šäº†è§£å—ï¼Ÿæƒ³çŸ¥é“å®ƒå°ç”Ÿç‰©æœ‰å¤šé‡è¦å—?é‚£å°±ä¾†åƒåŠ ç¬¬åå±†ç”ŸåŒ–ç‡Ÿå§ï¼èª²ç¨‹ä¸‰ï¼šåŒ–å¦å“ DIYï¼Œå…¶å¯¦ç”Ÿæ´»ä¸­çš„åŒ–å¦å“ï¼Œä¹Ÿå¯ä»¥è¦ªæ‰‹è£½ä½œï¼Œé€éä¸åŒåŒ–å­¸åŸæ–™çµ„æˆï¼Œåœ¨ç¶“éä¸åŒçš„åŒ–å­¸åæ‡‰ä¾¿å¯å¾—è®“ä½ è®Šæ¼‚äº®çš„åŒ–å¦å“ã€‚èª²ç¨‹å››ï¼š æ ¡å¤–åƒè¨ªã€‚")
```

```{r}
# 2021æ±æµ·å·¥è¨­ç‡Ÿ-HIDEsign  
camp <- modify_info(6, "æ±æµ·å¤§å­¸", "æ±æµ·å¤§å­¸", "2020/09/18-12/13","2021/1/23-1/27","15æ­²~18æ­²",
                    "https://scontent.ftpe8-3.fna.fbcdn.net/v/t1.0-9/s960x960/119734703_758480898328972_3563036071666036088_o.jpg?_nc_cat=107&_nc_sid=e3f864&_nc_ohc=XfgueKrtEqQAX9C16uv&_nc_oc=AQkIOmkaAn-qXXelDmIvRo4t-L2UAEufDhpbqLKL3rCHif6yc9wykE_X_ZtQcPfOOZQ&_nc_ht=scontent.ftpe8-3.fna&tp=7&oh=ad3e8d6dfcd2a018ad9841f3e3cfb94d&oe=5FA53522",
                    "å°‡è—‰ç”±è¨­è¨ˆèª²ç¨‹ã€å¯¦ä½œé«”é©—ã€åœ˜é«”æ´»å‹•ç­‰æ–¹å¼å¸¶é ˜å­¸å“¡èªè­˜å·¥æ¥­è¨­è¨ˆã€‚")
```

```{r}
# é›¢å²¸é¢¨é›»ç§‘å­¸ç‡Ÿ(å½°åŒ–å ´) 
camp <- modify_info(7, "åœ‹ç«‹è‡ºç£å¤§å­¸", "åœ‹ç«‹è‡ºç£å¤§å­¸", NA,"å ´æ¬¡ä¸€ï¼š2020/10/17 - 10/18, å ´æ¬¡äºŒï¼š2020/10/24 - 10/25","15æ­²~18æ­²",
                    "https://lh6.googleusercontent.com/fo7iMfgoAKjSMCiffw2qohGYrvXd9Wco82if0fFvKXhHupPfwVHoVYU_pmeKABRFi9HrKKd8jQC3m5fgDjQM3qisW4099fVnXjyErE_hUzFtqBqfxW7MFX9UCOB6=w740",
                    "é¢¨åŠ›ç™¼é›»æ˜¯å°ç£é‡é»ç™¼å±•é …ç›®ç§‘æŠ€ï¼Œè®“æˆ‘å€‘ä¸€èµ·è·Ÿè‘—è‡ºç£å¤§å­¸çš„æ•™æˆèˆ‡è³‡æ·±ç§‘å­¸è¬›å¸«å€‘ï¼Œä¸€èµ·ä¾†ç­è§£æ¢ç©¶èˆ‡å‹•æ‰‹å­¸ç¿’å§ï¼åƒèˆ‡å­¸å“¡é™¤äº†å¯ä»¥ç­è§£ä¸¦å‹•æ‰‹å­¸ç¿’æœ€å¤¯çš„èƒ½æºç§‘æŠ€å¤–ï¼Œé‚„å¯èˆ‡åœ‹ç«‹è‡ºç£å¤§å­¸æ•™æˆé¢å°é¢äº¤æµï¼Œä¸¦å‰è¿‘å¯¦åœ°åƒè¨ªï¼Œä»¥åŠå‹•æ‰‹çµ„è£å‡ºé¢¨åŠ›ç™¼é›»æ©Ÿï¼Œå…¨ç¨‹åƒèˆ‡ä¸¦é€šéè¬›å¸«èªè­‰å¾Œï¼Œå¯ç²åœ‹ç«‹è‡ºç£å¤§å­¸å–®ä½å­¸ç¿’è­‰æ›¸ï¼Œæœªä¾†å¯æ†‘æ­¤è­‰æ›¸å¯äº«æœ‰å„ªå…ˆåƒåŠ é€²éšä¸»é¡Œç§‘å­¸ç‡ŸéšŠæˆ–æ´»å‹•çš„æ¬Šåˆ©ã€‚")
```

```{r}
# ç”Ÿç‰©é†«å­¸  é›»å­å·¥ç¨‹å¯¦ä½œç‡Ÿ & å¿ƒç†è«®å•†æ¢ç´¢ç‡Ÿ 
camp <- modify_info(c(8,9), "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", NA, c("2020/10/18 æˆ– 2020/11/01", "2020/12/26"),"15æ­²~18æ­²",
                    "https://lh6.googleusercontent.com/s0f2uS_f6GayVxCTzwzkM2dNlcWBH2TkZVZF5Fl2OOPiAFcaZWXrip1FYBsVuyRZ9bGePlC2_EO9A-r64l0IQIr5wrAe44l6fApJ7AvAndHiwzgGkJrLGt5wkd2d=w758",
                    c("é€éå¯¦ä½œå’Œå²ä¸¹ä½›å¤§å­¸çš„å‰µæ„æ€è€ƒèª²ç¨‹æ¨¡å¼ï¼Œå¸¶ä½ äº†è§£é›»å­å·¥ç¨‹èˆ‡ç”Ÿç‰©é†«å­¸çµåˆçš„æ‡‰ç”¨ï¼é™¤ä»‹ç´¹äººé«”å§¿å‹¢èˆ‡å‹•ä½œçš„ç”Ÿç‰©åŠ›å­¸ï¼Œè®“å­¸å“¡ç­è§£ç”Ÿç‰©åŠ›å­¸æ‡‰ç”¨æ–¼é†«å­¸çš„å»£æ³›é¢å¤–ï¼Œåœ¨é†«å­¸é›»å­é›»è·¯å¯¦ä½œæ–¹é¢ï¼Œå°‡å¸¶é ˜å­¸ç”Ÿå¯¦éš›å‹•æ‰‹å®ŒæˆåŠ©è½å™¨ä½œå“ï¼Œä¸¦èªè­˜é†«ç™‚ç”¢å“æœ€åŸºç¤çš„æ§‹æˆã€‚çµåˆç†è«–èˆ‡å¯¦ä½œï¼Œå†æ­é…å¼•é€²å²ä¸¹å¤§å­¸çš„è¨­è¨ˆæ€è€ƒæ–¹æ³•ï¼Œè®“å­¸å“¡è…¦åŠ›æ¿€ç›ªå°‡æ‰€å¸æ”¶çš„é†«å­¸å·¥ç¨‹çŸ¥è­˜åŒ–ç‚ºå·±ç”¨ã€‚","ç‡ŸéšŠå®—æ—¨ä¸»è¦æ˜¯è®“åŒå­¸äº†è§£å¿ƒç†å­¸ç›¸é—œå…§å®¹ä»¥åŠè«®å•†æ¢ç´¢çš„éƒ¨åˆ†ï¼Œè—‰ç”±è€å¸«çš„å¼•å°è®“åŒå­¸å°å¿ƒç†å­¸æœ‰åˆæ­¥çš„æ¦‚å¿µåŠææ—©èªè­˜å¤§å­¸èª²ç¨‹å…§å®¹ï¼Œè®“åŒå­¸è—‰ç”±ç‡ŸéšŠäº†è§£æ­¤é ˜åŸŸæ˜¯å¦èˆ‡è‡ªèº«çš„èˆˆè¶£ç›¸ç¬¦ä¹Ÿå°ç§‘ç³»æ›´æœ‰æ¦‚å¿µï¼Œè€å¸«æœƒå¸¶é ˜åŒå­¸ç¤ºç¯„å¿ƒç†è«®å•†ç›¸é—œéç¨‹ï¼Œå»é«”é©—å¿ƒç†è«®å•†å¸«è¦æ€éº¼å»åŒç†æ‚£è€…åŠè§£æ±ºæ‚£è€…çš„å›°æ“¾ï¼Œæˆç‚ºè®“æ‚£è€…ä¾è³´å‚¾è¨´çš„å¿ƒç†è«®å•†å¸«ï¼Œé€éä¸€å¤©çš„ç‡ŸéšŠèª²ç¨‹ä¸­ä¹Ÿèƒ½å­¸åˆ°åˆæ­¥å…¥é–€çš„è«®å•†æŠ€å·§ï¼Œä¹Ÿèƒ½è®“äººéš›é—œä¿‚æ›´é€²ä¸€æ­¥ï¼"))
```

```{r}
# 2020è·å ´é”äººæ¢ç´¢ç‡Ÿ 
camp <- modify_info(10, "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", NA, "å•†ç®¡è²¡ç¶“ï¼2020/11/15;è³‡è¨Šå·¥ç¨‹ï¼2020/11/22;æ³•æ”¿å­¸ç¾¤ï¼2020/12/13;é†«è—¥è¡›ç”Ÿï¼2020/12/20","12æ­²~18æ­²",
                    "https://lh6.googleusercontent.com/D29I4n8qxeuuMUeOlb8WcPh1dE1r7ZlsXfprGkoEoyWte_0VdBCSeCR82iq7cvnCxy6Q8aM4NlQUHDnUQ6sOki9bGpSP08cF5yqYPwakdeLS-w38XsaxIDk0ZG9C=w1520",
                    "æ ¹æ“šèª¿æŸ¥é¡¯ç¤ºï¼Œæ¯å¹´èªç‚ºé¸éŒ¯ç§‘ç³»çš„å¤§å­¸ç”Ÿä¸å‹æšèˆ‰ï¼Œç”šè‡³å½±éŸ¿å­¸ç”Ÿä¹‹å¾Œåœ¨è·å ´ä¸­çš„è¡¨ç¾ï¼Œè€Œç•¶ä¸­æœ€å¤§çš„åŸå› å³æ˜¯å¤§å¤šçš„å­¸ç”Ÿä¸äº†è§£è‡ªå·±çš„æ€§å‘å’Œé¸ç³»é—œä¿‚ç¨‹åº¦ï¼Œå› æ­¤å°æ–¼ç§‘ç³»çš„èªè­˜åŠç›¸é—œè·æ¥­çš„èªè­˜å°±æ˜¯ä¸€å€‹å¾ˆé‡è¦çš„è­°é¡Œã€‚å› æ­¤æœ¬æ´»å‹•å¸Œæœ›è—‰ç”±èˆ‡ã€Œè·å ´é”äººäº’å‹•ã€å”åŠ©å­¸å­è¦åŠƒè·æ¶¯æ–¹å‘ã€‚è·å ´é”æ¢ç´¢ç‡Ÿèˆ‰è¾¦ã€Šé†«è—¥è¡›ç”Ÿé¡ã€‹ã€ã€Šå•†ç®¡è²¡ç¶“é¡ã€‹ã€ã€Šè³‡è¨Šèˆ‡å·¥ç¨‹å­¸ç¾¤é¡ã€‹ã€ã€Šæ³•æ”¿å­¸ç¾¤é¡ã€‹è·å ´è¬›åº§ï¼Œé‚€è«‹è©²é ˜åŸŸç¶“é©—è±å¯Œçš„é”äººï¼Œåˆ†äº«è·å ´ç§˜è¾›ç”˜è‹¦è«‡ï¼æ­¤è¡Œæ‰€éœ€çš„ç‰¹è³ªèƒ½åŠ›ï¼ç›®å‰ç”¢æ¥­ç‹€æ³ï¼Œä¸¦è—‰ç”±å¯¦ä½œèª²ç¨‹å¸¶é ˜ï¼Œè®“ä½ æ›´é€²ä¸€æ­¥ç­è§£ç”¢æ¥­ç¾æ³å¹«åŠ©ä½ æœªä¾†é¸å¡«ç§‘ç³»å¿—é¡˜ï¼")
```

```{r}
# MOCCä¸€æ—¥è€ƒç…§ç‡Ÿ 
camp <- modify_info(11, "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", NA, "Wordï¼2020/10/18 æˆ– 2021/03/14;Excelï¼2020/11/15 æˆ– 2021/05/23;PowerPointï¼2020/12/20 æˆ– 2021/07/11", "15æ­²~18æ­²",
                    "https://lh5.googleusercontent.com/S1_UHu5pBjl4qAcymdMAdwFcJmZAHki1a0wSZ0aqcotPk-KtfEqfJV_Xgcdg-uUBEQFYnvM9vEv07bVRGlhCBcPhqTy7w0hlxtZaApTdLWjV2-aTRRwcQc37oSg9=w1078",
                    "Word-æ’ç‰ˆåŠ›, Excel-çµ±æ•´åŠ›, PowerPoint-è¨­è¨ˆåŠ›")
```

```{r}
# æ™ºæ…§è­·ç†å…¨æ”»ç•¥ç ”ç¿’ç‡Ÿ 
camp <- modify_info(12, "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", "å¤§ç¢©é’å¹´é—œæ‡·åŸºé‡‘æœƒ", NA, "2020/12/12", "15æ­²~18æ­²",
                    "https://lh4.googleusercontent.com/XtB0Bn0Z03z7BiEBf9ExPonxR3zrSWzn_nc2Gs8-0xjJ9R3uCGx7bYCemxRJR7QphkHCDQut2X-4VZIdUJxU2Muymv-UzgFAJrqYeDWCzos_yCgg2D4L27Stp-_X=w1252",
                    "é†«ç™‚æ™ºæ…§åŒ–ç…§é¡§æ˜¯ç¾ä»£ä¹Ÿæ˜¯æœªä¾†çš„è¶¨å‹¢ï¼Œç‚ºè§£æ±ºè¨±å¤šç…§è­·å•é¡Œé–‹ç™¼å‡ºå…·æœ‰å‰µæ–°ã€ç§‘æŠ€çš„æ™ºæ…§ç…§è­·ç”¢å“ã€‚æœ¬ç‡ŸéšŠçµåˆäºæ´²å¤§å­¸è­·ç†å­¸é™¢è­·ç†å­¸ç³»ï¼Œç¶“ç”±è±å¯Œçš„æ´»å‹•å®‰æ’èˆ‡è¨­è¨ˆï¼Œä½¿åŒå­¸èº«è‡¨å…¶å¢ƒï¼Œåœ¨å­¸ç¿’çš„æƒ…å¢ƒä¸­å¯¦è¸ã€é«”é©—èˆ‡åæ€ï¼Œä¸¦å°æ–¼è­·ç†å­¸ç³»ä¹‹å°ˆæ¥­é ˜åŸŸæœ‰åˆæ­¥çš„èªè­˜ã€‚æœ¬æ¬¡æ´»å‹•é™¤äº†ç§‘ç³»ç°¡ä»‹ä¹‹å¤–ï¼Œå¦å®‰æ’å¯¦ä½œèª²ç¨‹ï¼ŒåŒ…å«æ‰‹è¡“å¯¦å¢ƒç§€ã€å­•å©¦åŠè€äººé«”é©—ã€å°å…’æ€¥æ•‘ç…§è­·è™•ç†ï¼Œæ›´æœ‰å…¨å°å”¯ä¸€ä¹‹ç”¢å©¦æ¨¡æ“¬äººVictoriaé«˜éšè¨­å‚™è®“åŒå­¸é«”é©—ç”Ÿç”¢å…¨è¨˜éŒ„ã€‚æœŸè¨±åŒå­¸åƒèˆ‡æœ¬æ¬¡ä¸€æ—¥é«”é©—ç‡Ÿå¾Œï¼Œèƒ½å¤ å¾ä¸­å°æ–¼æ™ºæ…§ç…§è­·èˆ‡è­·ç†å¾æ¥­äººå“¡æœ‰æ›´æ·±ä¸€å±¤çš„äº†è§£ï¼Œä¸¦å¾ä¸­åŸ¹é¤ŠåŒå­¸åœ˜éšŠåˆä½œã€æ‰¹åˆ¤æ€è€ƒåŠè§£æ±ºå•é¡Œçš„èƒ½åŠ›ã€‚")
```

```{r}
# ä½µå…¥activities
activities <- rbind(activities, camp)
```


* 2020 å¤ä»¤ç‡Ÿå’Œç‡ŸéšŠè³‡è¨Šï¼šhttps://ntdcamp.com/all-camp/ (part)
```{r}
summercamp.page.url<- paste0("https://ntdcamp.com/all-camp/page/",c(1:10),"/")

summercamp <- data.frame()
for (i in seq(summercamp.page.url)) {
  # title
  summercamp.title <- read_html(summercamp.page.url[i]) %>%
    html_nodes(xpath = "//div") %>%
    html_nodes("div.title-wrapper p a") %>% 
    html_text()

  # å¤ä»¤ç‡Ÿç¶²ç«™ä¸Šçš„æ´»å‹•é€£çµ
  summercamp.outer.url <- read_html(summercamp.page.url[i]) %>%
    html_nodes(xpath = "//div") %>%
    html_nodes("div.title-wrapper p a") %>% 
    html_attr(.,"href")
    
  # arrange title, img to a data frame
  summercamp <- data.frame("from" = "2020 å¤ä»¤ç‡Ÿå’Œç‡ŸéšŠè³‡è¨Š",
                           "title" = summercamp.title,
                           "outer_url" = summercamp.outer.url) %>% rbind(summercamp,.)
}
```

```{r}
# get camp inside information put in data frame l
l <- data.frame()
for (j in seq(summercamp$title)) {
  li <- summercamp$outer_url[j] %>% as.character %>%
    read_html(.) %>%
    html_nodes("div.product-short-description li") %>%
    html_text()  #  str_remove(.,"[\u4E00-\u9FFF]+(?=ï¼š)ï¼š")
  # img
  li[NROW(li) +1] <- summercamp$outer_url[j] %>% as.character %>%
    read_html(.) %>%
    html_nodes(xpath = "//div[2]/div") %>%
    html_nodes("div a img") %>%
    html_attr(.,"src") %>% .[3]
  
  li[NROW(li) + 1] <- summercamp$outer_url[j] %>% as.character %>%
    read_html(.) %>%
    html_nodes("div.tab-panels") %>%
    html_text() %>%
    str_remove_all(.,"[\n\t]+") %>%
    ifelse(rlang::is_empty(.), NA, .)

  l <- data.frame(title = summercamp$title[j], short_descrip = li) %>%
    rbind(l,.)
}
```

```{r}
# modify information  
summercamp <- l %>%
  mutate(title = as.character(title), short_descrip = as.character(short_descrip)) %>%
  group_by(title) %>%
  summarise(
    organizer = str_remove(short_descrip[1],"^ä¸»è¾¦å–®ä½ï¼š") %>% ifelse(str_detect(.,"ï¼š"),NA,.),
    reg_date = grepl("^æˆªæ­¢ï¼š",short_descrip) %>% 
      {ifelse(sum(.) == 0, NA,str_remove(short_descrip[
        grep("^æˆªæ­¢ï¼š",short_descrip)],
        "[\u4E00-\u9FFF]+(?=ï¼š)ï¼š"))},
    act_date = short_descrip %>% 
      .[str_which(., "(((æ™‚é–“)|(æ—¥æœŸ)|(æ—¥æœŸ )|(æ™‚é–“
                  ))(?=(ï¼š|&)))|(æ˜ŸæœŸ)")] %>% 
      str_remove(., 
                 "[[\u4E00-\u9FFF][:blank:][:punct:]]+(?=(ï¼š|&))ï¼š") %>% 
      paste0(.,collapse = ";"),
    url = short_descrip %>% .[str_which(.,"https")] %>% .[-c(10:12)] %>% 
      str_remove(.,"[\u4E00-\u9FFF]+(?=ï¼š)ï¼š") %>% paste0(.,collapse = ";"),
    img_url = short_descrip[NROW(title)-1],
    age_limit = short_descrip %>% .[str_which(.,"^å°è±¡ï¼š")] %>% 
      str_remove(.,"[\u4E00-\u9FFF]+(?=ï¼š)ï¼š") %>% paste0(.,collapse = ";"),
    description = ifelse(is.na(short_descrip[NROW(title)]), title, short_descrip[NROW(title)]),
    .groups = "drop"
  ) %>%
  left_join(summercamp, ., by = "title") %>%
  select(., -outer_url)

# æ’é™¤activitiesæœ‰åœ‹å°ã€å¹¼ç¨šåœ’çš„æ´»å‹•, 
# by using ".[grep("åœ‹å°|å¹¼å…’åœ’|æš‘å‡å¾Œå‡åœ‹ä¸€ ~ åœ‹ä¸‰|æš‘å‡å¾Œå‡å°å››~ å°å…­", .$age_limit),]" ä¾†ç¯©é¸
summercamp <- summercamp %>% .[-c(4,19,34,43,47,48,54,56,69,78),]
```

```{r}
# ä½µå…¥ activities
activities <- rbind(activities, summercamp) 
```

# output
```{r}
write.csv(activities, "activities.csv")
```


